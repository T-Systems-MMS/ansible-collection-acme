---
- name: Create RSA key to be used for acme account
  openssl_privatekey:
    path: "{{ acme_letsencrypt_account_key_path }}"
    size: 4096
    type: RSA
  when:
    - acme_letsencrypt_account_key_content is not defined
  no_log: true

- name: create account key file from acme_letsencrypt_account_key_content-variable
  copy:
    dest: "{{ acme_letsencrypt_account_key_path }}"
    content: "{{ acme_letsencrypt_account_key_content }}"
    mode: 0400
  when:
    - acme_letsencrypt_account_key_content is defined
  no_log: true

- name: Create RSA key to be used for certificate
  openssl_privatekey:
    path: "{{ acme_letsencrypt_private_key_path }}"
  when:
    - acme_letsencrypt_private_key_content is not defined
  no_log: true

- name: create private key file from acme_letsencrypt_private_key_content-variable
  copy:
    dest: "{{ acme_letsencrypt_private_key_path }}"
    content: "{{ acme_letsencrypt_private_key_content }}"
    mode: 0400
  when:
    - acme_letsencrypt_private_key_content is defined
  no_log: true
